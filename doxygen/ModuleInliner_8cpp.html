<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CIRCT: lib/Dialect/FIRRTL/Transforms/ModuleInliner.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CIRCT
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_1a25ec519b6c1121408b67cc33ce3f15.html">Dialect</a></li><li class="navelem"><a class="el" href="dir_5ecba3b4683443cdd5d71918532517b3.html">FIRRTL</a></li><li class="navelem"><a class="el" href="dir_1f43711e4003e7a9e3d354ad53319866.html">Transforms</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ModuleInliner.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="FIRRTL_2Transforms_2PassDetails_8h_source.html">PassDetails.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="FIRRTLAnnotations_8h_source.html">circt/Dialect/FIRRTL/FIRRTLAnnotations.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="FIRRTLOps_8h_source.html">circt/Dialect/FIRRTL/FIRRTLOps.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="FIRRTLTypes_8h_source.html">circt/Dialect/FIRRTL/FIRRTLTypes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="FIRRTLVisitors_8h_source.html">circt/Dialect/FIRRTL/FIRRTLVisitors.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Dialect_2FIRRTL_2Passes_8h_source.html">circt/Dialect/FIRRTL/Passes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="LLVM_8h_source.html">circt/Support/LLVM.h</a>&quot;</code><br />
<code>#include &quot;mlir/IR/BlockAndValueMapping.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ModuleInliner.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="ModuleInliner_8cpp__incl.png" border="0" usemap="#lib_2Dialect_2FIRRTL_2Transforms_2ModuleInliner_8cpp" alt=""/></div>
<map name="lib_2Dialect_2FIRRTL_2Transforms_2ModuleInliner_8cpp" id="lib_2Dialect_2FIRRTL_2Transforms_2ModuleInliner_8cpp">
<area shape="rect" title=" " alt="" coords="1341,5,1558,47"/>
<area shape="rect" href="FIRRTL_2Transforms_2PassDetails_8h.html" title=" " alt="" coords="1622,102,1731,129"/>
<area shape="rect" href="FIRRTLOps_8h.html" title=" " alt="" coords="1462,184,1610,225"/>
<area shape="rect" href="LLVM_8h.html" title=" " alt="" coords="848,549,1003,575"/>
<area shape="rect" href="FIRRTLAnnotations_8h.html" title=" " alt="" coords="260,363,421,404"/>
<area shape="rect" href="FIRRTLTypes_8h.html" title=" " alt="" coords="445,363,593,404"/>
<area shape="rect" href="FIRRTLVisitors_8h.html" title=" " alt="" coords="1320,95,1468,136"/>
<area shape="rect" href="Dialect_2FIRRTL_2Passes_8h.html" title=" " alt="" coords="1878,95,2026,136"/>
<area shape="rect" title=" " alt="" coords="2051,102,2286,129"/>
<area shape="rect" title=" " alt="" coords="1634,191,1761,218"/>
<area shape="rect" title=" " alt="" coords="1785,184,1933,225"/>
<area shape="rect" href="FIRRTLDialect_8h.html" title=" " alt="" coords="1910,452,2058,493"/>
<area shape="rect" href="FIRRTLOpInterfaces_8h.html" title=" " alt="" coords="1454,273,1619,315"/>
<area shape="rect" title=" " alt="" coords="1840,370,2004,397"/>
<area shape="rect" href="HWTypes_8h.html" title=" " alt="" coords="618,370,820,397"/>
<area shape="rect" href="FieldRef_8h.html" title=" " alt="" coords="1956,281,2128,307"/>
<area shape="rect" title=" " alt="" coords="2204,281,2338,307"/>
<area shape="rect" title=" " alt="" coords="2363,281,2550,307"/>
<area shape="rect" title=" " alt="" coords="2574,281,2776,307"/>
<area shape="rect" title=" " alt="" coords="2800,281,3014,307"/>
<area shape="rect" title=" " alt="" coords="814,273,995,315"/>
<area shape="rect" title=" " alt="" coords="1019,273,1206,315"/>
<area shape="rect" title=" " alt="" coords="1230,273,1378,315"/>
<area shape="rect" title=" " alt="" coords="1031,549,1218,575"/>
<area shape="rect" title=" " alt="" coords="1758,549,1885,575"/>
<area shape="rect" title=" " alt="" coords="1909,541,2060,583"/>
<area shape="rect" title=" " alt="" coords="2084,541,2234,583"/>
<area shape="rect" title=" " alt="" coords="748,631,900,657"/>
<area shape="rect" title=" " alt="" coords="924,631,1130,657"/>
<area shape="rect" href="FIRRTLAttributes_8h.html" title=" " alt="" coords="1668,363,1816,404"/>
<area shape="rect" title=" " alt="" coords="1058,370,1218,397"/>
<area shape="rect" title=" " alt="" coords="1242,370,1404,397"/>
<area shape="rect" title=" " alt="" coords="1429,370,1644,397"/>
<area shape="rect" title=" " alt="" coords="845,363,1033,404"/>
<area shape="rect" title=" " alt="" coords="251,459,414,486"/>
<area shape="rect" title=" " alt="" coords="46,452,227,493"/>
<area shape="rect" title=" " alt="" coords="1656,452,1827,493"/>
<area shape="rect" title=" " alt="" coords="762,459,881,486"/>
<area shape="rect" title=" " alt="" coords="590,452,738,493"/>
<area shape="rect" href="HWDialect_8h.html" title=" " alt="" coords="1257,459,1469,486"/>
<area shape="rect" title=" " alt="" coords="956,459,1183,486"/>
<area shape="rect" title=" " alt="" coords="1242,549,1476,575"/>
<area shape="rect" title=" " alt="" coords="1501,549,1734,575"/>
<area shape="rect" title=" " alt="" coords="2295,370,2412,397"/>
<area shape="rect" title=" " alt="" coords="2079,370,2271,397"/>
<area shape="rect" title=" " alt="" coords="1290,191,1438,218"/>
<area shape="rect" title=" " alt="" coords="1095,191,1266,218"/>
<area shape="rect" title=" " alt="" coords="1958,191,2136,218"/>
<area shape="rect" title=" " alt="" coords="2161,191,2314,218"/>
<area shape="rect" title=" " alt="" coords="2339,191,2416,218"/>
</map>
</div>
</div>
<p><a href="ModuleInliner_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8e041b4ac9b5d9b63e9552e7aec77c4f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ModuleInliner_8cpp.html#a8e041b4ac9b5d9b63e9552e7aec77c4f">rename</a> (StringRef prefix, Operation *op)</td></tr>
<tr class="memdesc:a8e041b4ac9b5d9b63e9552e7aec77c4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">If this operation or any child operation has a name, add the prefix to that operation's name.  <a href="ModuleInliner_8cpp.html#a8e041b4ac9b5d9b63e9552e7aec77c4f">More...</a><br /></td></tr>
<tr class="separator:a8e041b4ac9b5d9b63e9552e7aec77c4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06b57a9be1d74450a1901172a678aa33"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ModuleInliner_8cpp.html#a06b57a9be1d74450a1901172a678aa33">cloneAndRename</a> (StringRef prefix, OpBuilder &amp;b, BlockAndValueMapping &amp;mapper, Operation &amp;op)</td></tr>
<tr class="memdesc:a06b57a9be1d74450a1901172a678aa33"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clone an operation, mapping used values and results with the mapper, and apply the prefix to the name of the operation.  <a href="ModuleInliner_8cpp.html#a06b57a9be1d74450a1901172a678aa33">More...</a><br /></td></tr>
<tr class="separator:a06b57a9be1d74450a1901172a678aa33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9bea5cdc609db9f263fb99aa446e7b7"><td class="memItemLeft" align="right" valign="top">static SmallVector&lt; Value &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ModuleInliner_8cpp.html#ae9bea5cdc609db9f263fb99aa446e7b7">mapPortsToWires</a> (StringRef prefix, OpBuilder &amp;b, BlockAndValueMapping &amp;mapper, FModuleOp target)</td></tr>
<tr class="memdesc:ae9bea5cdc609db9f263fb99aa446e7b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is used before inlining a module, to handle the conversion between module ports and instance results.  <a href="ModuleInliner_8cpp.html#ae9bea5cdc609db9f263fb99aa446e7b7">More...</a><br /></td></tr>
<tr class="separator:ae9bea5cdc609db9f263fb99aa446e7b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1730a5f3c41d4a24c87c8bc8373157ac"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ModuleInliner_8cpp.html#a1730a5f3c41d4a24c87c8bc8373157ac">mapResultsToWires</a> (BlockAndValueMapping &amp;mapper, SmallVectorImpl&lt; Value &gt; &amp;wires, InstanceOp instance)</td></tr>
<tr class="memdesc:a1730a5f3c41d4a24c87c8bc8373157ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is used after inlining a module, to handle the conversion between module ports and instance results.  <a href="ModuleInliner_8cpp.html#a1730a5f3c41d4a24c87c8bc8373157ac">More...</a><br /></td></tr>
<tr class="separator:a1730a5f3c41d4a24c87c8bc8373157ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a06b57a9be1d74450a1901172a678aa33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06b57a9be1d74450a1901172a678aa33">&#9670;&nbsp;</a></span>cloneAndRename()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void cloneAndRename </td>
          <td>(</td>
          <td class="paramtype">StringRef&#160;</td>
          <td class="paramname"><em>prefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OpBuilder &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BlockAndValueMapping &amp;&#160;</td>
          <td class="paramname"><em>mapper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Operation &amp;&#160;</td>
          <td class="paramname"><em>op</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Clone an operation, mapping used values and results with the mapper, and apply the prefix to the name of the operation. </p>
<p>This will clone to the insert point of the builder. </p>

<p class="definition">Definition at line <a class="el" href="ModuleInliner_8cpp_source.html#l00048">48</a> of file <a class="el" href="ModuleInliner_8cpp_source.html">ModuleInliner.cpp</a>.</p>

<p class="reference">References <a class="el" href="ModuleInliner_8cpp_source.html#l00031">rename()</a>.</p>

</div>
</div>
<a id="ae9bea5cdc609db9f263fb99aa446e7b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9bea5cdc609db9f263fb99aa446e7b7">&#9670;&nbsp;</a></span>mapPortsToWires()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static SmallVector&lt;Value&gt; mapPortsToWires </td>
          <td>(</td>
          <td class="paramtype">StringRef&#160;</td>
          <td class="paramname"><em>prefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OpBuilder &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BlockAndValueMapping &amp;&#160;</td>
          <td class="paramname"><em>mapper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FModuleOp&#160;</td>
          <td class="paramname"><em>target</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function is used before inlining a module, to handle the conversion between module ports and instance results. </p>
<p>For every port in the target module, create a wire, and assign a mapping from each module port to the wire. When the body of the module is cloned, the value of the wire will be used instead of the module's ports. </p>

<p class="definition">Definition at line <a class="el" href="ModuleInliner_8cpp_source.html#l00059">59</a> of file <a class="el" href="ModuleInliner_8cpp_source.html">ModuleInliner.cpp</a>.</p>

</div>
</div>
<a id="a1730a5f3c41d4a24c87c8bc8373157ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1730a5f3c41d4a24c87c8bc8373157ac">&#9670;&nbsp;</a></span>mapResultsToWires()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void mapResultsToWires </td>
          <td>(</td>
          <td class="paramtype">BlockAndValueMapping &amp;&#160;</td>
          <td class="paramname"><em>mapper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SmallVectorImpl&lt; Value &gt; &amp;&#160;</td>
          <td class="paramname"><em>wires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InstanceOp&#160;</td>
          <td class="paramname"><em>instance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function is used after inlining a module, to handle the conversion between module ports and instance results. </p>
<p>This maps each wire to the result of the instance operation. When future operations are cloned from the current block, they will use the value of the wire instead of the instance results. </p>

<p class="definition">Definition at line <a class="el" href="ModuleInliner_8cpp_source.html#l00081">81</a> of file <a class="el" href="ModuleInliner_8cpp_source.html">ModuleInliner.cpp</a>.</p>

</div>
</div>
<a id="a8e041b4ac9b5d9b63e9552e7aec77c4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e041b4ac9b5d9b63e9552e7aec77c4f">&#9670;&nbsp;</a></span>rename()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void rename </td>
          <td>(</td>
          <td class="paramtype">StringRef&#160;</td>
          <td class="paramname"><em>prefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Operation *&#160;</td>
          <td class="paramname"><em>op</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>If this operation or any child operation has a name, add the prefix to that operation's name. </p>

<p class="definition">Definition at line <a class="el" href="ModuleInliner_8cpp_source.html#l00031">31</a> of file <a class="el" href="ModuleInliner_8cpp_source.html">ModuleInliner.cpp</a>.</p>

<p class="reference">References <a class="el" href="CalyxOps_8cpp_source.html#l00039">circt::calyx::direction::get()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ModuleInliner_8cpp_source.html#l00048">cloneAndRename()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Dec 6 2021 00:16:51 for CIRCT by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
